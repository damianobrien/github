<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title></title>
</head>

<body>
    <canvas id="canvas" width="200" height="200"></canvas>
</body>

<script type="text/javascript">
    var img_obj = {
        'source': null,
        'current': 0,
        'total_frames': 12,
        'width': 48,
        'height': 48
    };

    var img = new Image();
    img.onload = function() { // Triggered when image has finished loading.
        img_obj.source = img; // we set the image source for our object.
    }
    img.src = 'img/run.png'; // contains an image of size 256x16
    // with 16 frames of size 16x16

    function draw_anim(context, x, y, iobj) { // context is the canvas 2d context.
        // console.log("draw_anim");

        //wipe the background:
        context.fillStyle='white';
        context.fillRect(0,0,400,400);

        if (iobj.source != null)
            context.drawImage(iobj.source, iobj.current * iobj.width, 0,
                iobj.width, iobj.height,
                x, y, iobj.width, iobj.height);
        iobj.current = (iobj.current + 1) % iobj.total_frames;
        // incrementing the current frame and assuring animation loop
    }

    // function on_body_load() { // <body onload='on_body_load()'>...
    var canvas = document.getElementById("canvas");
    var context = canvas.getContext("2d");

        // setInterval((function(c, i) {
        //     return function() {
        //         draw_anim(c, 10, 10, i);
        //     };
        // })(context, img_obj), 100);
    // }

    function draw(){
        draw_anim(context, 48, 48, img_obj);
        requestAnimationFrame(draw);
    }
    draw();
    // var canvas = document.getElementById("canvas");
    // var ctx = canvas.getContext("2d");
    // ctx.fillStyle='red';
    // ctx.fillRect(50,50,100,200);
    // ctx.fillStyle='blue';
    // ctx.ellipse(200,200,50,50,0,0,Math.PI*2);
    // ctx.fill();
</script>

</html>
